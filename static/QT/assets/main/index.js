window.__require=function t(e,i,n){function c(s,a){if(!i[s]){if(!e[s]){var r=s.split("/");if(r=r[r.length-1],!e[r]){var h="function"==typeof __require&&__require;if(!a&&h)return h(r,!0);if(o)return o(r,!0);throw new Error("Cannot find module '"+s+"'")}s=r}var l=i[s]={exports:{}};e[s][0].call(l.exports,function(t){return c(e[s][1][t]||t)},l,l.exports,t,e,i,n)}return i[s].exports}for(var o="function"==typeof __require&&__require,s=0;s<n.length;s++)c(n[s]);return c}({api:[function(t,e,i){"use strict";cc._RF.push(e,"638f8+OZ1BA9YcPFEI0O7lo","api");var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(c,o){function s(t){try{r(n.next(t))}catch(e){o(e)}}function a(t){try{r(n.throw(t))}catch(e){o(e)}}function r(t){var e;t.done?c(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(s,a)}r((n=n.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var i,n,c,o,s={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(t){return function(e){return r([t,e])}}function r(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(c=2&o[0]?n.return:o[0]?n.throw||((c=n.return)&&c.call(n),0):n.next)&&!(c=c.call(n,o[1])).done)return c;switch(n=0,c&&(o=[2&o[0],c.value]),o[0]){case 0:case 1:c=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(c=(c=s.trys).length>0&&c[c.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!c||o[1]>c[0]&&o[1]<c[3])){s.label=o[1];break}if(6===o[0]&&s.label<c[1]){s.label=c[1],c=o;break}if(c&&s.label<c[2]){s.label=c[2],s.ops.push(o);break}c[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(a){o=[6,a],n=0}finally{i=c=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0}),i.getAllUserDetails=i.fetchQuestions=void 0;var o=t("./questionManager"),s=t("./userManager");i.fetchQuestions=function(t,e){return n(this,void 0,void 0,function(){var i,n;return c(this,function(c){switch(c.label){case 0:return i=new URL("https://swintapai.com/api/get_questions"),t&&i.searchParams.append("subject",t),e&&i.searchParams.append("education_level",e),[4,fetch(i.toString())];case 1:return[4,c.sent().json()];case 2:if(n=c.sent(),!Array.isArray(n))throw new Error("Unexpected response format");return o.setQuestions(n),[2]}})})},i.getAllUserDetails=function(){return n(this,void 0,void 0,function(){var t,e;return c(this,function(i){switch(i.label){case 0:return t=new URL("https://swintapai.com/api/get_profile"),[4,fetch(t.toString())];case 1:return[4,i.sent().json()];case 2:return(e=i.sent()).success&&(s.setUserDetails(e.profile),console.log("\u83b7\u53d6\u7528\u6237\u7684\u6570\u636e:"+e.profile)),[2]}})})},cc._RF.pop()},{"./questionManager":"questionManager","./userManager":"userManager"}],block:[function(t,e){"use strict";cc._RF.push(e,"a058bMvgA1MKpaE+XQr6es1","block"),cc.Class({extends:cc.Component,properties:{node_click:{default:null,type:cc.Node},audio_move:{default:null,type:cc.AudioClip},audio_win:{default:null,type:cc.AudioClip}},onLoad:function(){this.setTouch()},init:function(t,e){this.blockType=t,this.blockNum=e,this.xx=this.getPosArr().x,this.yy=this.getPosArr().y,this.node_click.active=!1,this.node_click.width=this.node.width,this.node_click.height=this.node.height},refreshArr:function(){this.xx=this.getPosArr().x,this.yy=this.getPosArr().y},setTouch:function(){this.node.on("touchstart",function(){this.posBlock=this.node.getPosition(),this.getPosBlock(),this.node_click.active=!0},this),this.node.on("touchmove",function(t){var e=t.getDelta();if("1_2"==this.blockType||"1_3"==this.blockType){if(this.posBlock.y+e.y<this.posBlockMin.y-8)return;if(this.posBlock.y+e.y>this.posBlockMax.y+8)return;this.posBlock=cc.v2(this.posBlock.x,this.posBlock.y+e.y)}else{if(this.posBlock.x+e.x<this.posBlockMin.x-8)return;if(0==this.blockNum&&this.getBlockPos(cc.v2(4,4)).x==this.posBlockMax.x)return this.posBlock=cc.v2(this.posBlock.x+e.x,this.posBlock.y),void this.node.setPosition(this.posBlock);if(this.posBlock.x+e.x>this.posBlockMax.x+8)return;this.posBlock=cc.v2(this.posBlock.x+e.x,this.posBlock.y)}this.node.setPosition(this.posBlock)},this),this.node.on("touchend",function(){this.touchEnd()},this),this.node.on("touchcancel",function(){this.touchEnd()},this)},touchEnd:function(){if(game.canEffect&&cc.audioEngine.play(this.audio_move,!1,1),0==this.blockNum&&this.pdGameOver()){var t=cc.moveBy(.3,cc.v2(300,0)),e=cc.callFunc(function(){game.gameOver()},this),i=cc.sequence(t,e);return this.node.runAction(i),void(game.canEffect&&cc.audioEngine.play(this.audio_win,!1,1))}this.xx=this.getPosArr().x,this.yy=this.getPosArr().y,this.setBlockPos(cc.v2(this.xx,this.yy)),game.getArrBlock(),this.node_click.active=!1},pdGameOver:function(){var t=this.node.getPosition(),e=this.getBlockPos(cc.v2(4,4));return t.x>=e.x&&(cc.log("\u95ef\u5173\u6210\u529f"),!0)},getPosBlock:function(){var t=cc.v2(this.xx,this.yy),e=cc.v2(this.xx,this.yy);if("1_2"==this.blockType||"1_3"==this.blockType){for(var i=1;i<10&&this.yy-i>=0&&0==game.arrBlock[this.yy-i][this.xx];i++)t=cc.v2(this.xx,this.yy-i);var n=1;n="1_2"==this.blockType?1:2;for(var c=1;c<10&&this.yy+n+c<6&&0==game.arrBlock[this.yy+n+c][this.xx];c++)e=cc.v2(this.xx,this.yy+n+c-n)}else{for(var o=1;o<10&&this.xx-o>=0&&0==game.arrBlock[this.yy][this.xx-o];o++)t=cc.v2(this.xx-o,this.yy);n=1,n="2_1"==this.blockType?1:2;for(var s=1;s<10&&this.xx+n+s<6&&0==game.arrBlock[this.yy][this.xx+n+s];s++)e=cc.v2(this.xx+n+s-n,this.yy)}this.posBlockMin=this.getBlockPos(t),this.posBlockMax=this.getBlockPos(e)},getPosArr:function(){this.posBlock=this.node.getPosition();var t=this.getPosZuoXiaJIao(this.posBlock),e=Math.floor(t.x/(game.block_WH+game.f_jiange)),i=Math.floor(t.y/(game.block_WH+game.f_jiange)),n=cc.v2(e,i),c=cc.v2(e,i);if("1_2"==this.blockType||"1_3"==this.blockType){c.y=n.y+1;var o;o="1_2"==this.blockType?4:3,n.y>o&&(n.y=o),c.y>o&&(c.y=o),n.y<0&&(n.y=0),c.y<0&&(c.y=0);var s=this.getBlockPos(n),a=this.getBlockPos(c);Math.abs(s.y-this.posBlock.y)>Math.abs(a.y-this.posBlock.y)&&(n.x=c.x,n.y=c.y)}else{c.x=n.x+1;var r;r="2_1"==this.blockType?4:3,n.x>r&&(n.x=r),c.x>r&&(c.x=r),n.x<0&&(n.x=0),c.x<0&&(c.x=0),s=this.getBlockPos(n),a=this.getBlockPos(c),Math.abs(s.x-this.posBlock.x)>Math.abs(a.x-this.posBlock.x)&&(n.x=c.x,n.y=c.y)}return n},setBlockPos:function(t){var e=cc.v2(game.blockParent.width/2,game.blockParent.width/2),i=cc.v2(t.x*(game.block_WH+game.f_jiange)-e.x+game.f_jiange,t.y*(game.block_WH+game.f_jiange)-e.y+game.f_jiange);this.node.setPosition(i)},getBlockPos:function(t){var e=cc.v2(game.blockParent.width/2,game.blockParent.width/2);return cc.v2(t.x*(game.block_WH+game.f_jiange)-e.x+game.f_jiange,t.y*(game.block_WH+game.f_jiange)-e.y+game.f_jiange)},getPosZuoXiaJIao:function(t){var e=cc.v2(game.blockParent.width/2+game.f_jiange,game.blockParent.width/2+game.f_jiange);return cc.v2(e.x+t.x,e.y+t.y)},update:function(){}}),cc._RF.pop()},{}],btnLevel:[function(t,e){"use strict";cc._RF.push(e,"a395c1ZgsVDjoSDI46BcrxW","btnLevel"),cc.Class({extends:cc.Component,properties:{label_num:{default:null,type:cc.Label}},onLoad:function(){},init:function(t){this.i_num=t,this.label_num.string=t},clickBtn:function(){cc.log("\u9009\u4e2d\u7684\u662f\u7b2c"+this.i_num+"\u5173"),game.playLevel(this.i_num)},start:function(){}}),cc._RF.pop()},{}],common:[function(t,e,i){"use strict";cc._RF.push(e,"0d4caYJOTNPiam/wt9vLaT1","common");var n,c=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,n){var c,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(c=t[a])&&(s=(o<3?c(s):o>3?c(e,i,s):c(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=cc._decorator,a=s.ccclass,r=s.property,h=t("./api"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bg=null,e.bg_1=[],e.node_arr=[],e.node_shuiBoWen=null,e.node_fish=null,e.particle_arr=[],e.autio_shui=null,e.timeShuiBoWen=0,e.timeRandomShuiBoWen=0,e.timeFish=0,e.timeRandomFish=0,e.pos_begin=cc.v2(0,0),e.pos_end=cc.v2(0,0),e}return c(e,t),e.prototype.onLoad=function(){window.common=this,this.playShuiBoWen(),this.playFish(),this.getQuestions(),this.getUserDetail(),this.timeRandomShuiBoWen=300+600*Math.random(),this.timeRandomFish=480+800*Math.random(),this.allParticleHide(),this.allNodeHide(),this.node_arr[0].active=!0},e.prototype.allParticleHide=function(){this.particle_arr.forEach(function(t){return t.node.active=!1})},e.prototype.allNodeHide=function(){this.node_arr.forEach(function(t){return t.active=!1})},e.prototype.playShuiBoWen=function(){var t,e=720*Math.random()-360,i=1280*Math.random()-640;this.node_shuiBoWen.setPosition(cc.v2(e,i)),this.node_shuiBoWen.getComponent(cc.Animation).play("shuiBoWen"),(null===(t=window.game)||void 0===t?void 0:t.canEffect)&&cc.audioEngine.play(this.autio_shui,!1,1)},e.prototype.playFish=function(){this.node_fish.stopAllActions();var t=this.node_fish.children;t.forEach(function(t){return t.active=!1}),t[Math.floor(3*Math.random())].active=!0;var e=[[cc.v2(420,568),cc.v2(-70,345),cc.v2(-460,650)],[cc.v2(-300,650),cc.v2(166,46),cc.v2(-180,-828)],[cc.v2(450,40),cc.v2(-170,-780)],[cc.v2(-500,-227),cc.v2(100,-747),cc.v2(300,730)]],i=Math.floor(Math.random()*e.length),n=[5,7,3.5,8][i],c=cc.cardinalSplineTo(n,e[i],0);this.node_fish.runAction(c)},e.prototype.start=function(){cc.log("start")},e.prototype.changeSkin=function(t){var e;this.allNodeHide(),this.allParticleHide(),cc.log("\u6570\u7ec4\u89d2\u6807\uff1a"+t),null===(e=window.game)||void 0===e||e.chengBlocks(t),this.node_arr[t].active=!0,this.bg.spriteFrame=this.bg_1[t],0!==t&&5!==t&&(7===t&&(this.particle_arr[0].node.active=!0),this.particle_arr[t].node.active=!0)},e.prototype.btnCallBack=function(t,e){this.allNodeHide(),this.allParticleHide(),cc.log(e);var i=Math.floor(10*Math.random());cc.log("\u6570\u7ec4\u89d2\u6807\uff1a"+i),window.game.i_skin=i,window.game.chengBlocks(),this.node_arr[i].active=!0,this.bg.spriteFrame=this.bg_1[i],0!==i&&5!==i&&(7===i&&(this.particle_arr[0].node.active=!0),this.particle_arr[i].node.active=!0)},e.prototype.update=function(){if(this.timeShuiBoWen++,this.timeShuiBoWen>this.timeRandomShuiBoWen&&(this.timeShuiBoWen=0,this.timeRandomShuiBoWen=300+600*Math.random(),this.playShuiBoWen()),this.timeFish++,this.timeFish>this.timeRandomFish&&(this.timeFish=0,this.timeRandomFish=500+300*Math.random(),this.playFish()),this.pos_end=cc.v2(this.node_fish.x,this.node_fish.y),this.pos_begin.x!==this.pos_end.x&&this.pos_begin.y!==this.pos_end.y){var t=this.getAngle(this.pos_begin,this.pos_end);this.node_fish.angle=-t}this.pos_begin=this.pos_end},e.prototype.getAngle=function(t,e){var i=e.x-t.x,n=e.y-t.y,c=i/Math.sqrt(i*i+n*n),o=Math.acos(c),s=180/(Math.PI/o);return n<0?s=-s:0===n&&i<0&&(s=180),90-s},e.prototype.getQuestions=function(){h.fetchQuestions("English","University")},e.prototype.getUserDetail=function(){h.getAllUserDetails()},o([r(cc.Sprite)],e.prototype,"bg",void 0),o([r([cc.SpriteFrame])],e.prototype,"bg_1",void 0),o([r([cc.Node])],e.prototype,"node_arr",void 0),o([r(cc.Node)],e.prototype,"node_shuiBoWen",void 0),o([r(cc.Node)],e.prototype,"node_fish",void 0),o([r([cc.ParticleSystem])],e.prototype,"particle_arr",void 0),o([r(cc.AudioClip)],e.prototype,"autio_shui",void 0),o([a],e)}(cc.Component);i.default=l,cc._RF.pop()},{"./api":"api"}],gameData:[function(t,e){"use strict";cc._RF.push(e,"99e41oxfpRFvIDWH65x2bs5","gameData"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){window.gameData=this,this.init()},init:function(){this.arr_blockType=[["2_1","1_2","1_3","1_3","2_1","3_1","3_1"],["2_1","1_2","1_2","1_2","1_3","2_1","3_1"],["2_1","1_2","1_2","1_3","1_3","2_1"],["2_1","1_2","1_2","1_3","2_1","3_1"],["2_1","1_2","1_2","1_3","2_1","2_1","3_1"],["2_1","1_2","1_3","2_1","3_1"],["2_1","1_2","1_2","2_1","2_1","2_1","2_1","3_1"],["2_1","1_2","1_3","1_3","2_1","2_1"],["2_1","1_2","1_2","1_3","1_3","2_1","2_1","3_1"],["2_1","1_2","1_3","1_3","1_3","2_1","2_1","2_1","2_1","3_1","3_1","3_1"]],this.arr_blockPos=[[cc.v2(0,3),cc.v2(1,1),cc.v2(3,1),cc.v2(5,2),cc.v2(3,4),cc.v2(2,0),cc.v2(1,5)],[cc.v2(1,3),cc.v2(4,1),cc.v2(1,1),cc.v2(0,2),cc.v2(3,2),cc.v2(4,4),cc.v2(2,5)],[cc.v2(0,3),cc.v2(3,3),cc.v2(5,4),cc.v2(5,1),cc.v2(2,2),cc.v2(2,1)],[cc.v2(0,3),cc.v2(4,0),cc.v2(5,3),cc.v2(3,1),cc.v2(1,1),cc.v2(0,5)],[cc.v2(0,3),cc.v2(3,4),cc.v2(1,1),cc.v2(5,1),cc.v2(3,1),cc.v2(0,5),cc.v2(3,0)],[cc.v2(0,3),cc.v2(2,2),cc.v2(4,2),cc.v2(4,1),cc.v2(0,4)],[cc.v2(0,3),cc.v2(3,3),cc.v2(5,3),cc.v2(0,0),cc.v2(0,1),cc.v2(3,5),cc.v2(0,5),cc.v2(3,2)],[cc.v2(1,3),cc.v2(0,3),cc.v2(2,0),cc.v2(4,3),cc.v2(4,2),cc.v2(0,0)],[cc.v2(0,3),cc.v2(1,0),cc.v2(2,4),cc.v2(5,0),cc.v2(4,2),cc.v2(2,2),cc.v2(0,4),cc.v2(2,0)],[cc.v2(2,3),cc.v2(4,3),cc.v2(2,0),cc.v2(1,1),cc.v2(0,3),cc.v2(3,0),cc.v2(0,0),cc.v2(3,5),cc.v2(1,5),cc.v2(3,1),cc.v2(3,2),cc.v2(1,4)]],this.arr_blockPos_TiShi=[[cc.v2(0,3),cc.v2(1,1),cc.v2(3,0),cc.v2(5,0),cc.v2(3,4),cc.v2(0,0),cc.v2(1,5)],[cc.v2(1,3),cc.v2(4,1),cc.v2(1,1),cc.v2(0,2),cc.v2(3,0),cc.v2(4,4),cc.v2(2,5)],[cc.v2(0,3),cc.v2(3,0),cc.v2(5,4),cc.v2(5,0),cc.v2(2,0),cc.v2(0,1)],[cc.v2(0,3),cc.v2(4,0),cc.v2(5,4),cc.v2(3,0),cc.v2(1,1),cc.v2(0,5)],[cc.v2(0,3),cc.v2(3,4),cc.v2(1,1),cc.v2(5,0),cc.v2(3,1),cc.v2(0,5),cc.v2(1,0)],[cc.v2(0,3),cc.v2(2,0),cc.v2(4,0),cc.v2(0,1),cc.v2(0,4)],[cc.v2(0,3),cc.v2(3,0),cc.v2(5,0),cc.v2(0,0),cc.v2(0,1),cc.v2(3,5),cc.v2(0,5),cc.v2(0,2)],[cc.v2(0,3),cc.v2(0,4),cc.v2(2,0),cc.v2(4,0),cc.v2(0,2),cc.v2(0,0)],[cc.v2(2,3),cc.v2(1,2),cc.v2(2,4),cc.v2(5,0),cc.v2(4,0),cc.v2(2,2),cc.v2(0,4),cc.v2(0,0)],[cc.v2(2,3),cc.v2(4,4),cc.v2(2,0),cc.v2(1,1),cc.v2(0,1),cc.v2(3,0),cc.v2(0,0),cc.v2(2,5),cc.v2(0,5),cc.v2(3,1),cc.v2(3,2),cc.v2(1,4)]]}}),cc._RF.pop()},{}],gameEdit:[function(t,e){"use strict";cc._RF.push(e,"fa6438epplPIJZVH57EEqpu","gameEdit"),cc.Class({extends:cc.Component,properties:{blockParent:{default:null,type:cc.Node},pre_block:{default:null,type:cc.Prefab},spf_block:{default:[],type:[cc.SpriteFrame]}},onLoad:function(){},btnClick:function(t,e){if(cc.log(e),"1_2"==e||"1_3"==e||"2_1"==e||"3_1"==e)this.addBlock(e);else if("logArr"==e)this.logArr();else if("cleanBlocks"==e)for(var i=this.blockParent.children,n=i.length-1;n>=0;n--)i[n].getComponent("block")&&i[n].removeFromParent()},addBlock:function(t){var e=cc.instantiate(this.pre_block);e.parent=this.blockParent,e.getComponent("block").init(t),"1_2"==t?(e.width=108,e.height=220,e.getComponent(cc.Sprite).spriteFrame=this.spf_block[0]):"1_3"==t?(e.width=108,e.height=332,e.getComponent(cc.Sprite).spriteFrame=this.spf_block[1]):"2_1"==t?(e.width=220,e.height=108,e.getComponent(cc.Sprite).spriteFrame=this.spf_block[2]):"3_1"==t&&(e.width=332,e.height=108,e.getComponent(cc.Sprite).spriteFrame=this.spf_block[3])},logArr:function(){for(var t=[],e=[],i=this.blockParent.children,n=0;n<i.length;n++){var c=i[n].getComponent("block");c&&(e.push(c.blockType),t.push("cc.v2("+c.xx+","+c.yy+")"))}cc.log(e),cc.log(t.toString())}}),cc._RF.pop()},{}],game:[function(t,e){"use strict";cc._RF.push(e,"e25f3XfqX9IZ67Gcus6VXVq","game");var i,n=(i=t("./question"))&&i.__esModule?i:{default:i},c=t("./userManager");cc.Class({extends:cc.Component,properties:{question:{default:null,type:cc.Prefab},nodeReady:{default:null,type:cc.Node},nodePlaying:{default:null,type:cc.Node},nodeOver:{default:null,type:cc.Node},nodeSkin:{default:null,type:cc.Node},nodeLevels:{default:null,type:cc.Node},nodeSetting:{default:null,type:cc.Node},nodeBtnPlaying:{default:null,type:cc.Node},pre_block_test:{default:null,type:cc.Prefab},blockParent:{default:null,type:cc.Node},pre_block:{default:null,type:cc.Prefab},pre_btnLevel:{default:null,type:cc.Prefab},spa_block:{default:[],type:[cc.SpriteAtlas]},spf_block:{default:[],type:[cc.SpriteFrame]},autio_btn:{default:null,type:cc.AudioClip},audio_bg:{default:[],type:[cc.AudioClip]}},onLoad:function(){this.btnStr=["101","102","103","104","105","106","107","108","109","110"],this.fishStr=["201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217"],this.canEffect=!0,this.canMusic=!0,this.maxLevel=10,this.gameType=0,this.timeScore=0,this.socreCurr=0,this.blockPool=new cc.NodePool,window.game=this,this.i_skin=0,this.block_skin=1,this.i_level=1,this.nodeReady.active=!0,this.nodePlaying.active=!1,this.nodeOver.active=!1,this.nodeSkin.active=!1,this.nodeLevels.active=!1,this.nodeSetting.active=!1,this.f_jiange=2,this.block_WH=110,this.initBtnPos(),this.setBlockParent();for(var t=0;t<gameData.arr_blockType[this.i_level-1].length;t++)this.addBlock(gameData.arr_blockType[this.i_level-1][t],gameData.arr_blockPos[this.i_level-1][t],t);this.getArrBlock(),this.refreshLevel(),this.nodeSkin.active=!1,this.skinContent=this.nodeSkin.getChildByName("scrollView").getChildByName("view").getChildByName("content"),this.skinContent.height=1420,this.skinContent.getChildByName("node_skin_1").active=!0,this.skinContent.getChildByName("node_skin_2").active=!1,this.xuanZhongSkin_1(0),this.xuanZhongSkin_2(0),this.levelContent=this.nodeLevels.getChildByName("pageView").getChildByName("view").getChildByName("content"),this.addBtnLevel(),this.canMusic&&(this.audioBg=cc.audioEngine.play(this.audio_bg[0],!0,1))},refreshLevel:function(){this.nodePlaying.getChildByName("mask").getChildByName("spLevel").getChildByName("labelLevel").getComponent(cc.Label).string=this.i_level,this.nodeOver.getChildByName("spLevel").getChildByName("labelLevel").getComponent(cc.Label).string=this.i_level-1},refreshScore:function(){var t=Math.floor(this.socreCurr/60),e=this.socreCurr%60;e<10&&(e="0"+e),this.nodeOver.getChildByName("currentScore").getComponent(cc.Label).string="\u5f53\u524d\u5206\u6570\uff1a"+t+":"+e;var i=cc.sys.localStorage.getItem("i_bestScore_"+this.i_level);i?i>this.socreCurr&&(i=this.socreCurr,cc.sys.localStorage.setItem("i_bestScore_"+this.i_level,i)):(i=this.socreCurr,cc.sys.localStorage.setItem("i_bestScore_"+this.i_level,i));var n=Math.floor(i/60),c=i%60;c<10&&(c="0"+c),this.nodeOver.getChildByName("bestScore").getComponent(cc.Label).string="\u6700\u4f73\u5206\u6570\uff1a"+n+":"+c},gameOver:function(){this.gameType=2,this.i_level++,this.i_level>this.maxLevel&&(this.i_level=this.maxLevel),this.refreshLevel(),this.nodeOver.active=!0,this.nodePlaying.active=!1,this.nodeReady.active=!1,this.refreshScore()},initArr:function(){this.arrBlock=[];for(var t=0;t<6;t++)this.arrBlock[t]=[];for(var e=0;e<6;e++)for(var i=0;i<6;i++)this.arrBlock[e][i]=0},getArrBlock:function(){this.initArr();for(var t=this.blockParent.children,e=0;e<t.length;e++){var i=t[e].getComponent("block");i&&(this.arrBlock[i.yy][i.xx]=1,"1_2"==i.blockType?this.arrBlock[i.yy+1][i.xx]=1:"1_3"==i.blockType?(this.arrBlock[i.yy+1][i.xx]=1,this.arrBlock[i.yy+2][i.xx]=1):"2_1"==i.blockType?this.arrBlock[i.yy][i.xx+1]=1:"3_1"==i.blockType&&(this.arrBlock[i.yy][i.xx+1]=1,this.arrBlock[i.yy][i.xx+2]=1))}this.logArrBlock()},logArrBlock:function(){for(var t=5;t>=0;t--);},addBlock_test:function(){for(var t=cc.v2(-this.blockParent.width/2,-this.blockParent.height/2),e=0;e<6;e++)for(var i=0;i<6;i++){var n=cc.instantiate(this.pre_block_test);n.parent=this.blockParent,n.width=this.block_WH,n.height=this.block_WH,n.getChildByName("labelXY").getComponent(cc.Label).string="("+e+","+i+")",n.setPosition(cc.v2(t.x+this.block_WH*i+this.f_jiange*i+this.block_WH/2+this.f_jiange,t.y+this.block_WH*e+this.f_jiange*e+this.block_WH/2+this.f_jiange))}},addBtnLevel:function(){for(var t=1,e=this.levelContent.children,i=0;i<e.length;i++)for(var n=0;n<7;n++)for(var c=0;c<4;c++){var o=cc.instantiate(this.pre_btnLevel);o.parent=e[i];var s=cc.v2(-240,e[i].height/2-o.height/2-20),a=cc.v2(s.x+160*c,s.y+-140*n);o.setPosition(a);var r=o.getComponent("btnLevel");r&&(r.init(t),t++)}},chengBlocks:function(t){this.i_skin=t;for(var e=this.blockParent.children,i=0;i<e.length;i++){var n=e[i].getComponent("block");if(n){if("1_2"==n.blockType&&(e[i].getComponent(cc.Sprite).spriteFrame=this.spa_block[this.i_skin].getSpriteFrame("1x2_nor"),e[i].getChildByName("click").getComponent(cc.Sprite).spriteFrame=this.spa_block[this.i_skin].getSpriteFrame("1x2_click")),"1_3"==n.blockType&&(e[i].getComponent(cc.Sprite).spriteFrame=this.spa_block[this.i_skin].getSpriteFrame("1x3_nor"),e[i].getChildByName("click").getComponent(cc.Sprite).spriteFrame=this.spa_block[this.i_skin].getSpriteFrame("1x3_click")),"2_1"==n.blockType){if(0==n.blockNum){e[i].getComponent(cc.Sprite).spriteFrame=this.spf_block[this.block_skin];continue}e[i].getComponent(cc.Sprite).spriteFrame=this.spa_block[this.i_skin].getSpriteFrame("2x1_nor"),e[i].getChildByName("click").getComponent(cc.Sprite).spriteFrame=this.spa_block[this.i_skin].getSpriteFrame("2x1_click")}"3_1"==n.blockType&&(e[i].getComponent(cc.Sprite).spriteFrame=this.spa_block[this.i_skin].getSpriteFrame("3x1_nor"),e[i].getChildByName("click").getComponent(cc.Sprite).spriteFrame=this.spa_block[this.i_skin].getSpriteFrame("3x1_click"))}}},chengBlockHero:function(t){this.block_skin=t;for(var e=this.blockParent.children,i=0;i<e.length;i++){var n=e[i].getComponent("block");if(n&&"2_1"==n.blockType&&0==n.blockNum)return void(e[i].getComponent(cc.Sprite).spriteFrame=this.spf_block[this.block_skin])}},onBlockKilled:function(t){this.blockPool.put(t)},addBlock:function(t,e,i){var n=null;(n=this.blockPool.size()>0?this.blockPool.get():cc.instantiate(this.pre_block)).parent=this.blockParent;var c=cc.v2(e.x*(this.block_WH+this.f_jiange),e.y*(this.block_WH+this.f_jiange));if(n.setPosition(this.getPosZXJ(c)),n.getComponent("block").init(t,i),"1_2"==t)n.width=108,n.height=220,n.getComponent(cc.Sprite).spriteFrame=this.spa_block[this.i_skin].getSpriteFrame("1x2_nor"),n.getChildByName("click").getComponent(cc.Sprite).spriteFrame=this.spa_block[this.i_skin].getSpriteFrame("1x2_click");else if("1_3"==t)n.width=108,n.height=332,n.getComponent(cc.Sprite).spriteFrame=this.spa_block[this.i_skin].getSpriteFrame("1x3_nor"),n.getChildByName("click").getComponent(cc.Sprite).spriteFrame=this.spa_block[this.i_skin].getSpriteFrame("1x3_click");else if("2_1"==t){if(n.width=220,n.height=108,0==i)return n.getComponent(cc.Sprite).spriteFrame=this.spf_block[this.block_skin],void(n.getChildByName("click").getComponent(cc.Sprite).spriteFrame=this.spf_block[0]);n.getComponent(cc.Sprite).spriteFrame=this.spa_block[this.i_skin].getSpriteFrame("2x1_nor"),n.getChildByName("click").getComponent(cc.Sprite).spriteFrame=this.spa_block[this.i_skin].getSpriteFrame("2x1_click")}else"3_1"==t&&(n.width=332,n.height=108,n.getComponent(cc.Sprite).spriteFrame=this.spa_block[this.i_skin].getSpriteFrame("3x1_nor"),n.getChildByName("click").getComponent(cc.Sprite).spriteFrame=this.spa_block[this.i_skin].getSpriteFrame("3x1_click"))},getPosZXJ:function(t){var e=cc.v2(-this.blockParent.width/2+this.f_jiange,-this.blockParent.width/2+this.f_jiange);return cc.v2(e.x+t.x,t.y+e.y)},playLevel:function(t){t>this.maxLevel&&(t=this.maxLevel),this.i_level=t,this.nodeLevels.active=!1,this.nodeOver.active=!1,this.nodePlaying.active=!0,this.nodeReady.active=!1,this.gameType=1,this.socreCurr=0,this.timeScore=0;for(var e=this.blockParent.children,i=e.length-1;i>=0;i--)e[i].getComponent("block")&&this.onBlockKilled(e[i]);for(var n=0;n<gameData.arr_blockType[this.i_level-1].length;n++)this.addBlock(gameData.arr_blockType[this.i_level-1][n],gameData.arr_blockPos[this.i_level-1][n],n);this.getArrBlock(),this.refreshLevel()},clickBtn:function(t,e){if(cc.log(e),game.canEffect&&cc.audioEngine.play(this.autio_btn,!1,1),"btnPlay_ready"==e){this.nodeReady.active=!1,this.nodePlaying.active=!0,this.nodeOver.active=!1,this.gameType=1,this.socreCurr=0,this.timeScore=0;for(var i=(s=this.blockParent.children).length-1;i>=0;i--)(u=s[i].getComponent("block"))&&this.onBlockKilled(s[i]);for(var o=0;o<gameData.arr_blockType[this.i_level-1].length;o++)this.addBlock(gameData.arr_blockType[this.i_level-1][o],gameData.arr_blockPos[this.i_level-1][o],o);this.getArrBlock()}else if("btnSkin_ready"==e)this.nodeSkin.active=!0,this.nodePlaying.active=!1,this.nodeReady.active=!1,this.nodeOver.active=!1,this.refreshSkin();else if("btnSetting_ready"==e)this.nodeSetting.active=!0;else if("btnHome_playing"==e)this.nodeReady.active=!0,this.nodePlaying.active=!1;else if("btnMenu_playing"==e)this.actMenu("btnMenu_playing");else if("btnSetting_playiny"==e)this.nodeSetting.active=!0;else if("btnMenuClose_playing"==e)this.actMenu("btnMenuClose_playing");else if("btnSkin_playiny"==e)this.nodeSkin.active=!0,this.nodePlaying.active=!1,this.nodeReady.active=!1,this.nodeOver.active=!1;else if("btnLevels_playiny"==e)this.nodeLevels.active=!0,this.nodeSkin.active=!1,this.nodePlaying.active=!1,this.nodeReady.active=!1,this.nodeOver.active=!1;else if("btnMenuReplay_playing"==e){for(var s=this.blockParent.children,a=0,r=0;r<s.length;r++)if(u=s[r].getComponent("block")){var h=gameData.arr_blockPos[this.i_level-1][a];a++;var l=cc.v2(h.x*(this.block_WH+this.f_jiange),h.y*(this.block_WH+this.f_jiange));s[r].setPosition(this.getPosZXJ(l)),u.refreshArr()}this.getArrBlock()}else if("btnMenuHint_playing"==e){s=this.blockParent.children,a=0;for(var g=0;g<s.length;g++)(u=s[g].getComponent("block"))&&(h=gameData.arr_blockPos_TiShi[this.i_level-1][a],a++,l=cc.v2(h.x*(this.block_WH+this.f_jiange),h.y*(this.block_WH+this.f_jiange)),s[g].setPosition(this.getPosZXJ(l)),u.refreshArr());this.getArrBlock()}else if("btnSkin_over"==e)this.nodeSkin.active=!0,this.nodePlaying.active=!1,this.nodeReady.active=!1,this.nodeOver.active=!1;else if("btnLevels_over"==e)this.nodeLevels.active=!0,this.nodeSkin.active=!1,this.nodePlaying.active=!1,this.nodeReady.active=!1,this.nodeOver.active=!1;else if("btn_rePlay_over"==e){this.gameType=1,this.socreCurr=0,this.timeScore=0,s=this.blockParent.children,a=0,this.i_level--,this.refreshLevel();for(var d=0;d<s.length;d++)(u=s[d].getComponent("block"))&&(h=gameData.arr_blockPos[this.i_level-1][a],a++,l=cc.v2(h.x*(this.block_WH+this.f_jiange),h.y*(this.block_WH+this.f_jiange)),s[d].setPosition(this.getPosZXJ(l)),u.refreshArr());this.getArrBlock(),this.nodeOver.active=!1,this.nodePlaying.active=!0,this.nodeReady.active=!1}else if("btn_nextPlay"==e){this.gameType=1,this.socreCurr=0,this.timeScore=0;for(var p=(s=this.blockParent.children).length-1;p>=0;p--){var u;(u=s[p].getComponent("block"))&&this.onBlockKilled(s[p])}this.nodeOver.active=!1,this.nodePlaying.active=!0,this.nodeReady.active=!1;for(var _=0;_<gameData.arr_blockType[this.i_level-1].length;_++)this.addBlock(gameData.arr_blockType[this.i_level-1][_],gameData.arr_blockPos[this.i_level-1][_],_);this.getArrBlock()}else if("toggle1"==e)this.skinContent.height=1420,this.skinContent.getChildByName("node_skin_1").active=!0,this.skinContent.getChildByName("node_skin_2").active=!1,this.refreshSkin();else if("toggle2"==e)this.skinContent.height=2400,this.skinContent.getChildByName("node_skin_1").active=!1,this.skinContent.getChildByName("node_skin_2").active=!0,this.refreshSkin();else if("btnBack_skin"==e)this.nodeSkin.active=!1,0==this.gameType?this.nodeReady.active=!0:1==this.gameType?this.nodePlaying.active=!0:2==this.gameType&&(this.nodeOver.active=!0);else if(e==this.btnStr[0]||e==this.btnStr[1]||e==this.btnStr[2]||e==this.btnStr[3]||e==this.btnStr[4]||e==this.btnStr[5]||e==this.btnStr[6]||e==this.btnStr[7]||e==this.btnStr[8]||e==this.btnStr[9]){for(var v=(0,c.getUserDetails)().unlocked_backgrounds,y=0;y<=9;y++)if(e==this.btnStr[y])if(v[y]){var f=parseInt(e);common.changeSkin(f-101),this.xuanZhongSkin_1(f-101),f-101==7?this.canMusic&&(cc.audioEngine.stop(this.audioBg),this.audioBg=cc.audioEngine.play(this.audio_bg[2],!0,1)):f-101==3||f-101==6?this.canMusic&&(cc.audioEngine.stop(this.audioBg),this.audioBg=cc.audioEngine.play(this.audio_bg[1],!0,1)):f-101==2?this.canMusic&&(cc.audioEngine.stop(this.audioBg),this.audioBg=cc.audioEngine.play(this.audio_bg[3],!0,1)):f-101==4?this.canMusic&&(cc.audioEngine.stop(this.audioBg),this.audioBg=cc.audioEngine.play(this.audio_bg[4],!0,1)):this.canMusic&&(cc.audioEngine.stop(this.audioBg),this.audioBg=cc.audioEngine.play(this.audio_bg[0],!0,1))}else{var k=cc.instantiate(this.question);k.getComponent(n.default).skinType="bg",k.getComponent(n.default).unlockSkinIndex=y,this.nodeSkin.addChild(k)}}else if(e==this.fishStr[0]||e==this.fishStr[1]||e==this.fishStr[2]||e==this.fishStr[3]||e==this.fishStr[4]||e==this.fishStr[5]||e==this.fishStr[6]||e==this.fishStr[7]||e==this.fishStr[8]||e==this.fishStr[9]||e==this.fishStr[10]||e==this.fishStr[11]||e==this.fishStr[12]||e==this.fishStr[13]||e==this.fishStr[14]||e==this.fishStr[15]||e==this.fishStr[16]){for(var b=(0,c.getUserDetails)().unlocked_fish_skins,m=0;m<17;m++)if(e==this.fishStr[m])if(b[m])f=parseInt(e),this.xuanZhongSkin_2(f-201),this.chengBlockHero(f-201+1);else{var B=cc.instantiate(this.question);B.getComponent(n.default).unlockSkinIndex=m,B.getComponent(n.default).skinType="fish",this.nodeSkin.addChild(B)}}else"btnHome_level"==e?(this.nodeLevels.active=!1,this.nodeSkin.active=!1,this.nodePlaying.active=!1,this.nodeReady.active=!0,this.nodeOver.active=!1):"btnSetting_level"==e?this.nodeSetting.active=!0:"btnClose_setting"==e?this.nodeSetting.active=!1:"btnMusicOff_setting"==e?(this.canMusic=!0,cc.audioEngine.resume(this.audioBg),this.nodeSetting.getChildByName("bg").getChildByName("btnMusicOn_setting").active=!0,this.nodeSetting.getChildByName("bg").getChildByName("btnMusicOff_setting").active=!1):"btnMusicOn_setting"==e?(this.canMusic=!1,cc.audioEngine.pause(this.audioBg),this.nodeSetting.getChildByName("bg").getChildByName("btnMusicOn_setting").active=!1,this.nodeSetting.getChildByName("bg").getChildByName("btnMusicOff_setting").active=!0):"btnSoundOff_setting"==e?(this.canEffect=!0,this.nodeSetting.getChildByName("bg").getChildByName("btnSoundOn_setting").active=!0,this.nodeSetting.getChildByName("bg").getChildByName("btnSoundOff_setting").active=!1):"btnSoundOn_setting"==e&&(this.canEffect=!1,this.nodeSetting.getChildByName("bg").getChildByName("btnSoundOn_setting").active=!1,this.nodeSetting.getChildByName("bg").getChildByName("btnSoundOff_setting").active=!0)},xuanZhongSkin_1:function(t){for(var e=this.skinContent.getChildByName("node_skin_1").children,i=0;i<e.length;i++)e[i].getChildByName("sp").active=i==t},xuanZhongSkin_2:function(t){for(var e=this.skinContent.getChildByName("node_skin_2").children,i=0;i<e.length;i++)i==t?(e[i].getChildByName("sp_2").active=!0,e[i].getChildByName("sp_1").active=!1):(e[i].getChildByName("sp_2").active=!1,e[i].getChildByName("sp_1").active=!0)},initBtnPos:function(){var t=this.nodeBtnPlaying.getChildByName("btnMenu_playing");cc.v2(t.x,t.y),this.nodeBtnPlaying.getChildByName("btnMenuClose_playing").active=!1,this.nodeBtnPlaying.getChildByName("btnMenuHint_playing").active=!0,this.nodeBtnPlaying.getChildByName("btnMenuReplay_playing").active=!0,this.nodeBtnPlaying.getChildByName("btnMenu_playing").active=!0,this.nodeBtnPlaying.getChildByName("btnHome_playing").active=!1,this.nodeBtnPlaying.getChildByName("btnLevels_playiny").active=!1,this.nodeBtnPlaying.getChildByName("btnSkin_playiny").active=!1,this.nodeBtnPlaying.getChildByName("btnSetting_playiny").active=!1},actMenu:function(t){var e=this.nodeBtnPlaying.getChildByName("btnMenu_playing"),i=cc.v2(e.x,e.y),n=Math.abs(e.x)/2;if("btnMenu_playing"==t)this.nodeBtnPlaying.getChildByName("btnHome_playing").active=!0,this.nodeBtnPlaying.getChildByName("btnLevels_playiny").active=!0,this.nodeBtnPlaying.getChildByName("btnSkin_playiny").active=!0,this.nodeBtnPlaying.getChildByName("btnSetting_playiny").active=!0,this.nodeBtnPlaying.getChildByName("btnHome_playing").runAction(cc.moveTo(.1,cc.v2(i.x+n,i.y))),this.nodeBtnPlaying.getChildByName("btnLevels_playiny").runAction(cc.moveTo(.14,cc.v2(i.x+2*n,i.y))),this.nodeBtnPlaying.getChildByName("btnSkin_playiny").runAction(cc.moveTo(.16,cc.v2(i.x+3*n,i.y))),this.nodeBtnPlaying.getChildByName("btnSetting_playiny").runAction(cc.moveTo(.17,cc.v2(i.x+4*n,i.y))),this.nodeBtnPlaying.getChildByName("btnMenuClose_playing").active=!0,this.nodeBtnPlaying.getChildByName("btnMenuHint_playing").active=!1,this.nodeBtnPlaying.getChildByName("btnMenuReplay_playing").active=!1,e.active=!1;else if("btnMenuClose_playing"==t){this.nodeBtnPlaying.getChildByName("btnMenuClose_playing").active=!1,e.active=!0;var c=cc.moveTo(.1,cc.v2(i.x,i.y)),o=cc.callFunc(function(){this.nodeBtnPlaying.getChildByName("btnHome_playing").active=!1}.bind(this)),s=cc.moveTo(.14,cc.v2(i.x,i.y)),a=cc.callFunc(function(){this.nodeBtnPlaying.getChildByName("btnLevels_playiny").active=!1}.bind(this)),r=cc.moveTo(.16,cc.v2(i.x,i.y)),h=cc.callFunc(function(){this.nodeBtnPlaying.getChildByName("btnSkin_playiny").active=!1}.bind(this)),l=cc.moveTo(.17,cc.v2(i.x,i.y)),g=cc.callFunc(function(){this.nodeBtnPlaying.getChildByName("btnSetting_playiny").active=!1,this.nodeBtnPlaying.getChildByName("btnMenuHint_playing").active=!0,this.nodeBtnPlaying.getChildByName("btnMenuReplay_playing").active=!0}.bind(this));this.nodeBtnPlaying.getChildByName("btnHome_playing").runAction(cc.sequence(c,o)),this.nodeBtnPlaying.getChildByName("btnLevels_playiny").runAction(cc.sequence(s,a)),this.nodeBtnPlaying.getChildByName("btnSkin_playiny").runAction(cc.sequence(r,h)),this.nodeBtnPlaying.getChildByName("btnSetting_playiny").runAction(cc.sequence(l,g))}},setBlockParent:function(){this.blockParent.width=6*this.block_WH+7*this.f_jiange,this.blockParent.height=6*this.block_WH+7*this.f_jiange,this.blockParent.scale=.95;var t=this.blockParent.getChildByName("sp_shang");t.width=this.blockParent.width+10,t.y=this.blockParent.height/2+5;var e=this.blockParent.getChildByName("sp_xia");e.width=this.blockParent.width+10,e.y=-this.blockParent.height/2-5;var i=this.blockParent.getChildByName("sp_zuo");i.height=this.blockParent.height+10,i.x=-this.blockParent.width/2-5;var n=this.blockParent.getChildByName("sp_you_shang");n.height=2*this.block_WH+2*this.f_jiange,n.x=this.blockParent.width/2+5,n.y=this.blockParent.height/2+5;var c=this.blockParent.getChildByName("sp_you_xia");c.height=3*this.block_WH+3*this.f_jiange,c.x=this.blockParent.width/2+5,c.y=-this.blockParent.height/2-5;var o=this.blockParent.getChildByName("sp_you_shang_1");o.width=2*this.block_WH+2*this.f_jiange,o.x=this.blockParent.width/2+5,o.y=n.y-n.height;var s=this.blockParent.getChildByName("sp_you_xia_1");s.width=2*this.block_WH+2*this.f_jiange,s.x=this.blockParent.width/2+5,s.y=c.y+c.height;var a=this.blockParent.getChildByName("sp_shang_1");a.width=this.blockParent.width+60,a.y=this.blockParent.height/2+30;var r=this.blockParent.getChildByName("sp_xia_1");r.width=this.blockParent.width+60,r.y=-this.blockParent.height/2-30;var h=this.blockParent.getChildByName("sp_zuo_1");h.height=this.blockParent.height+60,h.x=-this.blockParent.width/2-30;var l=this.blockParent.getChildByName("sp_you_shang_11");l.height=2*this.block_WH+2*this.f_jiange,l.x=this.blockParent.width/2+30,l.y=this.blockParent.height/2+30;var g=this.blockParent.getChildByName("sp_you_xia_11");g.height=3*this.block_WH+3*this.f_jiange,g.x=this.blockParent.width/2+30,g.y=-this.blockParent.height/2-30;var d=this.blockParent.getChildByName("sp_you_shang_1_11");d.width=2*this.block_WH+2*this.f_jiange,d.x=this.blockParent.width/2+30,d.y=l.y-l.height;var p=this.blockParent.getChildByName("sp_you_xia_1_11");p.width=2*this.block_WH+2*this.f_jiange,p.x=this.blockParent.width/2+30,p.y=g.y+g.height},update:function(){1==this.gameType&&(this.timeScore++,this.timeScore>=60&&(this.timeScore=0,this.socreCurr++))},refreshSkin:function(){for(var t=(0,c.getUserDetails)().unlocked_backgrounds,e=(0,c.getUserDetails)().unlocked_fish_skins,i=this.skinContent.getChildByName("node_skin_1").children,n=this.skinContent.getChildByName("node_skin_2").children,o=0;o<i.length;o++){t[o]?i[o].opacity=255:i[o].opacity=150;for(var s=0;s<n.length;s++)e[s]?n[s].opacity=255:n[s].opacity=140}}}),cc._RF.pop()},{"./question":"question","./userManager":"userManager"}],questionManager:[function(t,e,i){"use strict";cc._RF.push(e,"e6875oArWBCk6qmnWu4vaSH","questionManager"),Object.defineProperty(i,"__esModule",{value:!0}),i.getQuestionByIndex=i.getRandomQuestions=i.getAllQuestions=i.setQuestions=void 0;var n=[];function c(){return n}i.setQuestions=function(t){n=t},i.getAllQuestions=c,i.getRandomQuestions=function(t){return c().sort(function(){return Math.random()-.5}).slice(0,t)},i.getQuestionByIndex=function(t){return n[t]||null},cc._RF.pop()},{}],question:[function(t,e,i){"use strict";cc._RF.push(e,"6a434iEazxKnaVvCptL5+D7","question");var n,c=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,n){var c,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(c=t[a])&&(s=(o<3?c(s):o>3?c(e,i,s):c(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},s=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),c=0;for(e=0;e<i;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,c++)n[c]=o[s];return n};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,h=a.property,l=t("./questionManager"),g=t("./userManager"),d=t("./api"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.question_label=null,e.options=[],e.btn_close=null,e.btn_back=null,e.btn_next=null,e.btn_submit=null,e.toast=null,e.skinType="bg",e.unlockSkinIndex=0,e.currentOptions=[],e.correctAnswer="",e.currentIndex=0,e.questions=[],e.userAnswers=[],e}return c(e,t),e.prototype.onLoad=function(){var t=this;this.questions=l.getRandomQuestions(5),this.currentIndex=0,this.userAnswers=Array(this.questions.length).fill(-1),this.setQuestionDataFromCurrent(),this.btn_next.on(cc.Node.EventType.TOUCH_END,function(){t.currentIndex<t.questions.length-1&&(t.currentIndex++,t.setQuestionDataFromCurrent())},this),this.btn_submit.on(cc.Node.EventType.TOUCH_END,function(){for(var e=!0,i=0;i<t.questions.length;i++){var n=t.questions[i].answer,c=t.userAnswers[i];if(-1===c||t.questions[i].options[c].charAt(0)!==n){e=!1,t.showToast("\u274c wrong answer, try again");break}}if(e){var o=g.getUserDetails(),a=void 0,r=void 0;"fish"==t.skinType?(a=s(o.unlocked_fish_skins),r="unlocked_fish_skins"):"bg"==t.skinType&&(a=s(o.unlocked_backgrounds),r="unlocked_backgrounds"),a[t.unlockSkinIndex]=!0,fetch("/api/update_profile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({field:r,value:a})}),d.getAllUserDetails(),t.showToast("\u2705 Perfect, unlock skin!");var h=t.node.parent.getChildByName("scrollView").getChildByName("view").getChildByName("content");"fish"==t.skinType?h.getChildByName("node_skin_2").children[t.unlockSkinIndex].opacity=255:"bg"==t.skinType&&(h.getChildByName("node_skin_1").children[t.unlockSkinIndex].opacity=255),t.scheduleOnce(function(){t.node.removeFromParent(),t.node.destroy()},1)}else t.showToast("\u274c wrong answer, try again")},this),this.btn_back.on(cc.Node.EventType.TOUCH_END,function(){t.currentIndex>0&&(t.currentIndex--,t.setQuestionDataFromCurrent())},this),this.btn_close.on(cc.Node.EventType.TOUCH_END,function(){t.node.removeFromParent(),t.node.destroy()},this)},e.prototype.setQuestionDataFromCurrent=function(){var t=this.questions[this.currentIndex];this.setQuestionData(t.description,t.options,t.answer),this.btn_back.active=this.currentIndex>0,this.btn_next.active=this.currentIndex<this.questions.length-1,this.btn_submit.active=this.currentIndex>=this.questions.length-1},e.prototype.setQuestionData=function(t,e,i){var n=this;this.question_label.string=t,this.currentOptions=e,this.correctAnswer=i;for(var c=function(t){var c=o.options[t].getChildByName("answer_label").getComponent(cc.Label);if(c&&(c.string=e[t]),o.options[t].off(cc.Node.EventType.TOUCH_END),o.options[t].on(cc.Node.EventType.TOUCH_END,function(){return n.onOptionSelected(t)},o),o.userAnswers[o.currentIndex]===t){var s=e[t].charAt(0)===i;o.options[t].color=s?cc.Color.GREEN:cc.Color.BLACK}else o.options[t].color=cc.Color.WHITE},o=this,s=0;s<this.options.length;s++)c(s)},e.prototype.onOptionSelected=function(t){this.userAnswers[this.currentIndex]=t;for(var e=this.currentOptions[t].charAt(0)===this.correctAnswer,i=0;i<this.options.length;i++)this.options[i].color=i===t?e?cc.Color.GREEN:cc.Color.BLACK:cc.Color.WHITE},e.prototype.showToast=function(t){this.toast.getChildByName("label").getComponent(cc.Label).string=t,this.toast.opacity=255,this.toast.setPosition(0,-200),cc.tween(this.toast).to(.5,{position:cc.v3(0,50,0)}).delay(.8).to(.5,{opacity:0}).start()},o([h(cc.Label)],e.prototype,"question_label",void 0),o([h([cc.Node])],e.prototype,"options",void 0),o([h(cc.Node)],e.prototype,"btn_close",void 0),o([h(cc.Node)],e.prototype,"btn_back",void 0),o([h(cc.Node)],e.prototype,"btn_next",void 0),o([h(cc.Node)],e.prototype,"btn_submit",void 0),o([h(cc.Node)],e.prototype,"toast",void 0),o([r],e)}(cc.Component);i.default=p,cc._RF.pop()},{"./api":"api","./questionManager":"questionManager","./userManager":"userManager"}],use_reversed_rotateBy:[function(t,e){"use strict";cc._RF.push(e,"594afcjrShFM4766ofxu36F","use_reversed_rotateBy"),cc.RotateBy._reverse=!0,cc._RF.pop()},{}],userManager:[function(t,e,i){"use strict";var n;cc._RF.push(e,"7c701TK1btNnJVT5mb0uOHN","userManager"),Object.defineProperty(i,"__esModule",{value:!0}),i.getUserDetails=i.setUserDetails=void 0,i.setUserDetails=function(t){n=t},i.getUserDetails=function(){return n},cc._RF.pop()},{}]},{},["use_reversed_rotateBy","api","block","btnLevel","common","game","gameData","gameEdit","question","questionManager","userManager"]);